<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Las Gambusinas Dashboard v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#0a0a0f',
            card: '#1a1a28',
            sidebar: '#12121a',
            gold: '#d4af37',
            'gold-20': 'rgba(212,175,55,0.125)',
            'gold-40': 'rgba(212,175,55,0.25)',
            muted: '#a0a0b8',
            'muted-dark': '#5a5a7a',
            libre: '#00d4aa',
            esperando: '#ffa502',
            pedido: '#3498db',
            preparado: '#2ecc71',
            pagado: '#ff4757',
            reservado: '#5352ed',
          },
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
        },
      },
    };
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.min.js"></script>
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-card: #1a1a28;
      --bg-sidebar: #12121a;
      --gold: #d4af37;
      --gold-20: rgba(212,175,55,0.125);
      --gold-40: rgba(212,175,55,0.25);
      --text-muted: #a0a0b8;
    }
    body { font-family: 'Inter', system-ui, sans-serif; }
    [x-cloak] { display: none !important; }
    .sidebar-item-active { background: var(--gold-20); border-left: 4px solid var(--gold); color: var(--gold); }
    .table-header { background: #12121a; }
    .btn-gold { background: #d4af37; color: #0a0a0f; }
    .btn-gold:hover { background: #c4a030; }
    .btn-outline-gold { border: 1px solid #d4af37; color: #d4af37; }
    .btn-outline-gold:hover { background: var(--gold-20); }
  </style>
</head>
<body class="bg-primary text-white min-h-screen" x-data="dashboardApp()" x-init="init()">

<div class="min-h-screen flex flex-col">
  <!-- TOPBAR 72px -->
  <nav class="h-[72px] bg-sidebar border-b border-gold-40 flex items-center px-4 md:px-6 shrink-0">
    <button @click="sidebarOpen = !sidebarOpen" class="p-2 rounded-lg hover:bg-gold-20 text-gold md:hidden">
      <i data-lucide="menu" class="w-6 h-6"></i>
    </button>
    <div class="flex items-center gap-4 flex-1 min-w-0">
      <div class="hidden md:flex items-center gap-2 text-muted text-sm">
        <span>üè†</span>
        <span x-text="breadcrumb"></span>
      </div>
      <div class="flex-1 max-w-md mx-2">
        <div class="relative" @click.away="searchOpen = false">
          <input type="text" x-model="searchQuery" @focus="searchOpen = true" @keydown.escape="searchOpen = false"
            placeholder="Buscar mesas, comandas, platos... (Ctrl+K)" class="w-full h-11 pl-4 pr-10 rounded-full bg-card border border-gold-40 text-white placeholder-muted focus:ring-1 focus:ring-gold focus:border-gold">
          <i data-lucide="search" class="w-5 h-5 absolute right-3 top-1/2 -translate-y-1/2 text-muted"></i>
          <!-- Dropdown b√∫squeda -->
          <div x-show="searchOpen" x-cloak class="absolute top-full left-0 right-0 mt-1 bg-card rounded-lg border border-gold-40 shadow-xl z-50 max-h-80 overflow-auto">
            <template x-if="searchQuery.length >= 2">
              <div class="p-2">
                <div class="text-muted text-xs uppercase px-2 py-1">Platos</div>
                <template x-for="r in searchResults.platos" :key="r.id">
                  <div class="px-3 py-2 rounded hover:bg-gold-20 cursor-pointer flex justify-between" @click="navigateTo('platos'); searchOpen = false">
                    <span x-text="r.nombre"></span>
                    <span class="text-gold" x-text="'S/.' + r.precio"></span>
                  </div>
                </template>
                <div class="text-muted text-xs uppercase px-2 py-1 mt-2">Mesas</div>
                <template x-for="r in searchResults.mesas" :key="r.id">
                  <div class="px-3 py-2 rounded hover:bg-gold-20 cursor-pointer" @click="navigateTo('mesas'); searchOpen = false" x-text="'Mesa ' + r.numero"></div>
                </template>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>
    <div class="flex items-center gap-2 shrink-0">
      <div class="hidden sm:flex flex-col items-end text-sm">
        <span class="font-bold text-white" x-text="clockTime"></span>
        <span class="text-muted text-xs" x-text="clockDate"></span>
      </div>
      <div class="w-px h-8 bg-gold-40 hidden sm:block"></div>
      <div class="relative" @click.away="statusOpen = false">
        <button @click="statusOpen = !statusOpen" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gold-20">
          <span class="w-2 h-2 rounded-full bg-preparado"></span>
          <span class="text-sm hidden md:inline">Online</span>
        </button>
        <div x-show="statusOpen" x-cloak class="absolute right-0 top-full mt-1 w-72 bg-card border border-gold-40 rounded-lg shadow-xl z-50 p-4">
          <div class="font-semibold text-gold mb-2">Estado del Sistema</div>
          <div class="text-sm space-y-1 text-muted">Cocina: 2 clientes ¬∑ Mozos: 8 ¬∑ Admin: 1</div>
          <div class="text-xs text-preparado mt-2">MongoDB OK ¬∑ API OK ¬∑ Latencia 12ms</div>
        </div>
      </div>
      <div class="w-px h-8 bg-gold-40 hidden sm:block"></div>
      <div class="relative" @click.away="shortcutsOpen = false">
        <button @click="shortcutsOpen = !shortcutsOpen; notificationsOpen = false; profileOpen = false" class="p-2 rounded-lg hover:bg-gold-20 text-gold relative">
          <i data-lucide="zap" class="w-5 h-5"></i>
        </button>
        <div x-show="shortcutsOpen" x-cloak class="absolute right-0 top-full mt-1 w-64 bg-card border border-gold-40 rounded-lg shadow-xl z-50 p-3">
          <div class="font-semibold text-gold mb-2">Atajos R√°pidos</div>
          <div class="text-sm space-y-1">
            <div class="flex justify-between py-1"><span @click="currentPage = 'comandas'; shortcutsOpen = false" class="cursor-pointer hover:text-gold">Nueva comanda</span><span class="text-muted">Ctrl+N</span></div>
            <div class="flex justify-between py-1"><span @click="currentPage = 'mesas'; shortcutsOpen = false" class="cursor-pointer hover:text-gold">Mapa mesas</span><span class="text-muted">Ctrl+M</span></div>
            <div class="flex justify-between py-1"><span @click="currentPage = 'reportes'; shortcutsOpen = false" class="cursor-pointer hover:text-gold">Reportes</span><span class="text-muted">Ctrl+R</span></div>
            <div class="flex justify-between py-1"><span @click="currentPage = 'configuracion'; shortcutsOpen = false" class="cursor-pointer hover:text-gold">Configuraci√≥n</span><span class="text-muted">Ctrl+,</span></div>
          </div>
          <div class="text-muted text-xs mt-2">Esc para cerrar</div>
        </div>
      </div>
      <div class="relative" @click.away="notificationsOpen = false">
        <button @click="notificationsOpen = !notificationsOpen; profileOpen = false; shortcutsOpen = false" class="p-2 rounded-lg hover:bg-gold-20 text-gold relative">
          <i data-lucide="bell" class="w-5 h-5"></i>
          <span class="absolute -top-0.5 -right-0.5 w-4 h-4 bg-pagado rounded-full text-xs flex items-center justify-center" x-show="notifUnread > 0" x-text="notifUnread"></span>
        </button>
        <div x-show="notificationsOpen" x-cloak class="absolute right-0 top-full mt-1 w-80 bg-card border border-gold-40 rounded-lg shadow-xl z-50 overflow-hidden">
          <div class="p-3 border-b border-gold-40 flex justify-between items-center">
            <span class="font-semibold">Notificaciones</span>
            <button class="text-gold text-sm">Marcar le√≠das</button>
          </div>
          <div class="max-h-64 overflow-auto">
            <template x-for="n in notifications" :key="n.id">
              <div class="p-3 border-b border-white/5 hover:bg-gold-20 flex gap-2" :class="!n.leida && 'bg-gold-20'">
                <span :class="n.urgente ? 'text-pagado' : 'text-esperando'" x-text="n.icono"></span>
                <div class="flex-1 min-w-0">
                  <div class="text-sm" x-text="n.texto"></div>
                  <div class="text-xs text-muted" x-text="n.hora"></div>
                </div>
              </div>
            </template>
          </div>
          <div class="p-2 text-center"><a href="#" class="text-gold text-sm">Ver todas</a></div>
        </div>
      </div>
      <div class="relative" @click.away="profileOpen = false">
        <button @click="profileOpen = !profileOpen; notificationsOpen = false; shortcutsOpen = false" class="flex items-center gap-2 p-1 rounded-full border-2 border-gold">
          <div class="w-9 h-9 rounded-full bg-gold/30 flex items-center justify-center text-gold font-bold">A</div>
          <span class="w-2 h-2 rounded-full bg-preparado absolute bottom-0 right-0 border-2 border-sidebar"></span>
        </button>
        <div x-show="profileOpen" x-cloak class="absolute right-0 top-full mt-1 w-64 bg-card border border-gold-40 rounded-lg shadow-xl z-50 overflow-hidden">
          <div class="p-4 text-center border-b border-gold-40">
            <div class="w-14 h-14 rounded-full bg-gold/30 mx-auto flex items-center justify-center text-gold font-bold text-xl mb-2">A</div>
            <div class="font-semibold">Admin Principal</div>
            <div class="text-muted text-sm">admin@lasgambusinas.com</div>
            <span class="inline-block mt-1 px-2 py-0.5 rounded-full bg-gold/20 text-gold text-xs">Administrador</span>
          </div>
          <div class="p-2">
            <a href="#" class="flex items-center gap-2 px-3 py-2 rounded hover:bg-gold-20"><i data-lucide="user" class="w-4 h-4"></i> Mi perfil</a>
            <a href="#" class="flex items-center gap-2 px-3 py-2 rounded hover:bg-gold-20" @click="currentPage = 'configuracion'; profileOpen = false"><i data-lucide="settings" class="w-4 h-4"></i> Configuraci√≥n</a>
            <div class="flex items-center justify-between px-3 py-2"><span>Modo oscuro</span><div class="w-10 h-5 rounded-full bg-gold flex justify-end items-center px-1"><span class="w-4 h-4 rounded-full bg-primary"></span></div></div>
            <button class="flex items-center gap-2 px-3 py-2 rounded w-full text-pagado hover:bg-pagado/20"><i data-lucide="log-out" class="w-4 h-4"></i> Cerrar sesi√≥n</button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div class="flex flex-1 min-h-0">
    <!-- SIDEBAR 270px / colapsado 68px -->
    <aside :class="sidebarOpen ? 'w-[270px]' : 'w-[68px]'" class="bg-sidebar border-r border-gold-40 shrink-0 transition-all duration-200 hidden md:flex md:flex-col overflow-hidden">
      <div class="p-4 border-b border-gold-40 flex items-center gap-2 shrink-0">
        <div class="w-10 h-10 rounded-lg bg-gold/20 flex items-center justify-center text-gold shrink-0"><span class="text-xl">üçΩÔ∏è</span></div>
        <span class="font-semibold text-gold truncate" x-show="sidebarOpen">Las Gambusinas</span>
      </div>
      <nav class="flex-1 overflow-y-auto py-2">
        <template x-for="item in menuItems" :key="item.id">
          <button @click="currentPage = item.id; currentReportTab = item.id === 'reportes' ? 'general' : currentReportTab; currentConfigTab = item.id === 'configuracion' ? 'general' : currentConfigTab"
            class="w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gold-20 transition-colors"
            :class="currentPage === item.id ? 'sidebar-item-active' : 'text-muted'">
            <span class="shrink-0 text-lg" x-text="item.icon"></span>
            <span class="truncate" x-show="sidebarOpen" x-text="item.label"></span>
          </button>
        </template>
      </nav>
      <div class="p-2 border-t border-gold-40">
        <button @click="sidebarOpen = !sidebarOpen" class="w-full flex items-center justify-center gap-2 py-2 rounded hover:bg-gold-20 text-muted">
          <i :data-lucide="sidebarOpen ? 'panel-left-close' : 'panel-left'" class="w-5 h-5"></i>
          <span x-show="sidebarOpen">Colapsar</span>
        </button>
      </div>
    </aside>

    <!-- Overlay m√≥vil sidebar -->
    <div x-show="sidebarOpen" x-cloak @click="sidebarOpen = false" class="fixed inset-0 bg-black/60 z-40 md:hidden"></div>
    <aside x-show="sidebarOpen" x-cloak class="fixed top-[72px] left-0 bottom-0 w-64 bg-sidebar border-r border-gold-40 z-50 md:hidden overflow-y-auto">
      <nav class="py-2">
        <template x-for="item in menuItems" :key="item.id">
          <button @click="currentPage = item.id; sidebarOpen = false"
            class="w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gold-20"
            :class="currentPage === item.id ? 'sidebar-item-active' : 'text-muted'">
            <span x-text="item.icon"></span>
            <span x-text="item.label"></span>
          </button>
        </template>
      </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 overflow-auto p-4 md:p-6 bg-primary">
      <!-- Dashboard -->
      <div x-show="currentPage === 'dashboard'" class="space-y-6">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <div>
            <h1 class="text-2xl font-bold" x-text="'Buenas ' + saludo + ', Admin'"></h1>
            <p class="text-muted" x-text="clockDate"></p>
          </div>
          <div class="flex gap-2">
            <button class="px-4 py-2 rounded-lg border border-gold-40 text-gold hover:bg-gold-20">Actualizar</button>
            <button class="px-4 py-2 rounded-lg border border-gold-40 text-gold hover:bg-gold-20">Exportar</button>
            <button @click="modalPersonalizar = true" class="px-4 py-2 rounded-lg btn-gold font-medium">Personalizar Dashboard</button>
          </div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4">
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <div class="text-muted text-sm">Mesas Ocupadas</div>
            <div class="text-2xl font-bold text-gold mt-1" x-text="dashboardKpis.mesasOcupadas + '/' + dashboardKpis.mesasTotal"></div>
          </div>
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <div class="text-muted text-sm">Ventas Hoy</div>
            <div class="text-2xl font-bold text-gold mt-1" x-text="'S/.' + dashboardKpis.ventasHoy"></div>
          </div>
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <div class="text-muted text-sm">Top Plato</div>
            <div class="text-xl font-bold mt-1" x-text="dashboardKpis.topPlato"></div>
          </div>
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <div class="text-muted text-sm">Top Mozo</div>
            <div class="text-xl font-bold mt-1" x-text="dashboardKpis.topMozo"></div>
          </div>
          <div class="bg-card p-4 rounded-xl border border-pagado/40">
            <div class="text-muted text-sm">Alertas</div>
            <div class="text-xl font-bold text-pagado mt-1" x-text="dashboardKpis.alertas"></div>
          </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <h3 class="font-semibold mb-4">Ventas por Hora</h3>
            <canvas id="chartVentasHora" height="200"></canvas>
          </div>
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <h3 class="font-semibold mb-4">Mapa de Mesas</h3>
            <div class="grid grid-cols-5 gap-2">
              <template x-for="m in mesasMapa" :key="m.id">
                <div class="aspect-square rounded-lg flex items-center justify-center text-xs font-medium cursor-pointer hover:ring-2 ring-gold"
                  :style="'background-color:' + mesaColor(m.estadoColor)" :title="'Mesa ' + m.numero" x-text="m.numero"></div>
              </template>
            </div>
          </div>
        </div>
        <div class="bg-card rounded-xl p-4 border border-gold-40">
          <h3 class="font-semibold mb-4">Actividad Reciente</h3>
          <ul class="space-y-2">
            <template x-for="a in actividadReciente" :key="a.id">
              <li class="flex items-center gap-3 py-2 border-b border-white/5 last:border-0">
                <span class="text-muted text-sm" x-text="a.hora"></span>
                <span x-text="a.texto"></span>
              </li>
            </template>
          </ul>
        </div>
      </div>

      <!-- Mesas -->
      <div x-show="currentPage === 'mesas'" class="space-y-4">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <h1 class="text-xl font-bold">Gesti√≥n de Mesas</h1>
          <div class="flex gap-2">
            <button class="px-3 py-1.5 rounded-lg bg-pagado/20 text-pagado border border-pagado/40">LIBRE TOTAL</button>
            <div class="flex rounded-lg border border-gold-40 p-0.5">
              <button @click="vistaMesas = 'tarjetas'" :class="vistaMesas === 'tarjetas' ? 'bg-gold text-primary' : 'text-muted'" class="px-3 py-1.5 rounded">Tarjetas</button>
              <button @click="vistaMesas = 'tabla'" :class="vistaMesas === 'tabla' ? 'bg-gold text-primary' : 'text-muted'" class="px-3 py-1.5 rounded">Tabla</button>
            </div>
            <button @click="openModalMesa()" class="px-4 py-2 rounded-lg btn-gold font-medium">+ Nueva Mesa</button>
          </div>
        </div>
        <div class="flex flex-wrap gap-2">
          <input type="text" x-model="filtroMesas" placeholder="Buscar mesa..." class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white w-48">
          <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white" x-model="filtroAreaMesas"><option value="">Todas √°reas</option><template x-for="a in mockData.areas" :key="a.id"><option :value="a.id" x-text="a.nombre"></option></template></select>
          <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white" x-model="filtroEstadoMesas"><option value="">Todos</option><option value="libre">Libre</option><option value="ocupada">Ocupada</option></select>
        </div>
        <template x-if="vistaMesas === 'tarjetas'">
          <div class="space-y-6">
            <template x-for="area in mockData.areas" :key="area.id">
              <div>
                <h3 class="text-gold font-semibold mb-3" x-text="area.nombre"></h3>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3">
                  <template x-for="m in mesasFiltradas.filter(x => x.areaId === area.id)" :key="m.id">
                    <div class="bg-card rounded-xl p-4 border cursor-pointer hover:border-gold border-gold-40">
                      <div class="font-bold" x-text="'Mesa ' + m.numero"></div>
                      <div class="text-sm mt-1"><span class="rounded px-2 py-0.5 text-xs bg-gold/20" x-text="m.estado"></span></div>
                      <div class="text-muted text-xs mt-2" x-show="m.mozo" x-text="m.mozo"></div>
                      <div class="text-gold text-sm mt-1" x-show="m.monto" x-text="'S/.' + m.monto"></div>
                    </div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </template>
        <template x-if="vistaMesas === 'tabla'">
          <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="table-header"><tr><th class="text-left p-3">#</th><th class="text-left p-3">√Årea</th><th class="text-left p-3">Estado</th><th class="text-left p-3">Mozo</th><th class="text-left p-3">Monto</th><th class="text-left p-3">Acciones</th></tr></thead>
              <tbody>
                <template x-for="m in mesasFiltradas" :key="m.id">
                  <tr class="border-t border-white/5 hover:bg-gold-20">
                    <td class="p-3" x-text="m.numero"></td>
                    <td class="p-3" x-text="m.areaNombre"></td>
                    <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-gold/20" x-text="m.estado"></span></td>
                    <td class="p-3 text-muted" x-text="m.mozo || '-'"></td>
                    <td class="p-3 text-gold" x-text="m.monto ? 'S/.' + m.monto : '-'"></td>
                    <td class="p-3"><button @click="verDetalleMesa(m)" class="text-gold hover:underline">Ver</button></td>
                  </tr>
                </template>
              </tbody>
            </table>
          </div>
        </template>
      </div>

      <!-- √Åreas -->
      <div x-show="currentPage === 'areas'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">√Åreas del Restaurante</h1>
          <button @click="openModalArea()" class="px-4 py-2 rounded-lg btn-gold font-medium">+ Nueva √Årea</button>
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">ID</th><th class="text-left p-3">Nombre</th><th class="text-left p-3">Descripci√≥n</th><th class="text-left p-3">Estado</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="a in mockData.areas" :key="a.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3" x-text="a.id"></td>
                  <td class="p-3" x-text="a.nombre"></td>
                  <td class="p-3 text-muted" x-text="a.descripcion || '-'"></td>
                  <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-preparado/20 text-preparado">Activo</span></td>
                  <td class="p-3"><button class="text-gold hover:underline">Editar</button> <button class="text-pagado hover:underline ml-2">Eliminar</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Mozos -->
      <div x-show="currentPage === 'mozos'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">Gesti√≥n de Mozos</h1>
          <button @click="openModalMozo()" class="px-4 py-2 rounded-lg btn-gold font-medium">+ Nuevo Mozo</button>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Activos hoy</div><div class="text-2xl font-bold text-gold" x-text="mockData.mozos.length"></div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Total</div><div class="text-2xl font-bold" x-text="mockData.mozos.length"></div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Mejor mozo</div><div class="text-lg font-semibold" x-text="mockData.mozos[0]?.nombre || '-'"></div></div>
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">ID</th><th class="text-left p-3">Nombre</th><th class="text-left p-3">DNI</th><th class="text-left p-3">Tel√©fono</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="m in mockData.mozos" :key="m.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3" x-text="m.id"></td>
                  <td class="p-3" x-text="m.nombre"></td>
                  <td class="p-3 text-muted" x-text="m.dni"></td>
                  <td class="p-3" x-text="m.telefono"></td>
                  <td class="p-3"><button @click="openModalMozo(m)" class="text-gold hover:underline">Editar</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Platos -->
      <div x-show="currentPage === 'platos'" class="space-y-4">
        <div class="flex flex-wrap justify-between items-center gap-4">
          <h1 class="text-xl font-bold">Carta / Platos</h1>
          <div class="flex gap-2">
            <button class="px-3 py-2 rounded-lg border border-gold-40 text-gold">Actualizar</button>
            <button class="px-3 py-2 rounded-lg border border-gold-40 text-gold">Importar JSON</button>
            <button @click="openModalPlato()" class="px-4 py-2 rounded-lg btn-gold font-medium">+ Nuevo Plato</button>
          </div>
        </div>
        <div class="flex gap-2 flex-wrap">
          <button @click="platosTab = 'todos'" :class="platosTab === 'todos' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg">Todos (53)</button>
          <button @click="platosTab = 'desayuno'" :class="platosTab === 'desayuno' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg">Desayuno (15)</button>
          <button @click="platosTab = 'carta'" :class="platosTab === 'carta' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg">Carta (38)</button>
          <button @click="platosTab = 'inactivos'" :class="platosTab === 'inactivos' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg">Inactivos (3)</button>
        </div>
        <div class="flex gap-4 flex-col lg:flex-row">
          <div class="flex-1 min-w-0">
            <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
              <table class="w-full text-sm">
                <thead class="table-header"><tr><th class="text-left p-3">#</th><th class="text-left p-3">Nombre</th><th class="text-left p-3">Precio</th><th class="text-left p-3">Stock</th><th class="text-left p-3">Categor√≠a</th><th class="text-left p-3">Complementos</th><th class="text-left p-3">Acc.</th></tr></thead>
                <tbody>
                  <template x-for="(p, i) in mockData.platos" :key="p.id">
                    <tr class="border-t border-white/5 hover:bg-gold-20">
                      <td class="p-3" x-text="i + 1"></td>
                      <td class="p-3"><span x-text="p.nombre"></span><div class="text-muted text-xs" x-text="p.subcategoria || ''"></div></td>
                      <td class="p-3 text-gold" x-text="'S/.' + p.precio"></td>
                      <td class="p-3"><span class="rounded px-2 py-0.5 text-xs" :class="p.stock < 10 ? 'bg-pagado/20' : 'bg-preparado/20'" x-text="p.stock"></span></td>
                      <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-pedido/20" x-text="p.categoria"></span></td>
                      <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-gold/20 text-gold" x-text="(p.complementos?.length || 0) + ' grupos'"></span></td>
                      <td class="p-3"><button @click="openModalPlato(p)" class="text-gold hover:underline">Editar</button></td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
            <div class="text-muted text-sm mt-2">Mostrando 6 de 53 platos</div>
          </div>
          <div class="w-full lg:w-56 shrink-0 space-y-4">
            <div class="bg-card rounded-xl p-4 border border-gold-40">
              <h3 class="font-semibold text-gold mb-2">Categor√≠as</h3>
              <ul class="space-y-1 text-sm">
                <template x-for="c in categoriasPlatos" :key="c.nombre"><li class="flex justify-between"><span x-text="c.nombre"></span><span x-text="c.count"></span></li></template>
              </ul>
              <button class="mt-2 text-gold text-sm">+ Nueva categor√≠a</button>
            </div>
            <div class="bg-card rounded-xl p-4 border border-gold-40">
              <h3 class="font-semibold text-gold mb-2">Complementos</h3>
              <div class="text-muted text-sm">Platos con complementos: 18 de 32</div>
              <div class="text-muted text-sm">Grupos: 42 ¬∑ Opciones: 136</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Comandas -->
      <div x-show="currentPage === 'comandas'" class="space-y-4">
        <h1 class="text-xl font-bold">Comandas</h1>
        <div class="flex flex-wrap gap-2">
          <input type="text" placeholder="ID Comanda" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <input type="text" placeholder="Mesa" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white"><option>Estado</option></select>
          <input type="text" placeholder="Mozo" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <button class="px-4 py-2 rounded-lg btn-gold">Actualizar</button>
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">#</th><th class="text-left p-3">Mesa</th><th class="text-left p-3">Mozo</th><th class="text-left p-3">Items</th><th class="text-left p-3">Total</th><th class="text-left p-3">Estado</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="c in mockData.comandas" :key="c.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3" x-text="c.id"></td>
                  <td class="p-3" x-text="c.mesa"></td>
                  <td class="p-3" x-text="c.mozo"></td>
                  <td class="p-3" x-text="c.items"></td>
                  <td class="p-3 text-gold" x-text="'S/.' + c.total"></td>
                  <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-esperando/20" x-text="c.estado"></span></td>
                  <td class="p-3"><button @click="openModalComanda(c)" class="text-gold hover:underline">Ver</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Bouchers -->
      <div x-show="currentPage === 'bouchers'" class="space-y-4">
        <h1 class="text-xl font-bold">Bouchers</h1>
        <div class="flex gap-2">
          <input type="date" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <button class="px-4 py-2 rounded-lg btn-gold">Filtrar</button>
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">C√≥digo</th><th class="text-left p-3">N¬∞ Boucher</th><th class="text-left p-3">Fecha</th><th class="text-left p-3">Total</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="b in mockData.bouchers" :key="b.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3" x-text="b.codigo"></td>
                  <td class="p-3" x-text="b.numero"></td>
                  <td class="p-3" x-text="b.fecha"></td>
                  <td class="p-3 text-gold" x-text="'S/.' + b.total"></td>
                  <td class="p-3"><button @click="openModalBoucher(b)" class="text-gold hover:underline">Ver</button> <button class="text-gold hover:underline ml-2">PDF</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Clientes -->
      <div x-show="currentPage === 'clientes'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">Clientes</h1>
          <div class="flex gap-2">
            <button class="px-4 py-2 rounded-lg btn-gold">Exportar CSV</button>
            <button class="px-4 py-2 rounded-lg border border-gold-40 text-gold">Actualizar</button>
          </div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Total</div><div class="text-2xl font-bold text-gold" x-text="mockData.clientes.length"></div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Nuevos este mes</div><div class="text-2xl font-bold text-preparado">23</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Frecuentes</div><div class="text-2xl font-bold text-gold">85</div></div>
        </div>
        <div class="flex flex-wrap gap-2">
          <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white"><option>Todos</option></select>
          <input type="text" placeholder="Nombre" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <input type="text" placeholder="DNI" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">Nombre</th><th class="text-left p-3">DNI</th><th class="text-left p-3">Tel√©fono</th><th class="text-left p-3">Visitas</th><th class="text-left p-3">Gasto Total</th><th class="text-left p-3">Tipo</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="c in mockData.clientes" :key="c.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3" x-text="c.nombre"></td>
                  <td class="p-3 text-muted" x-text="c.dni"></td>
                  <td class="p-3" x-text="c.telefono"></td>
                  <td class="p-3" x-text="c.visitas"></td>
                  <td class="p-3 text-gold" x-text="'S/.' + c.gastoTotal"></td>
                  <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-preparado/20" x-text="c.tipo"></span></td>
                  <td class="p-3"><button @click="openModalCliente(c)" class="text-gold hover:underline">Editar</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Auditor√≠a -->
      <div x-show="currentPage === 'auditoria'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">Auditor√≠a</h1>
          <div class="flex gap-2">
            <input type="date" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
            <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white"><option>Acci√≥n</option></select>
            <button class="px-4 py-2 rounded-lg btn-gold">Reporte Completo</button>
          </div>
        </div>
        <div class="bg-card rounded-xl border border-gold-40 overflow-x-auto">
          <table class="w-full text-sm">
            <thead class="table-header"><tr><th class="text-left p-3">Hora</th><th class="text-left p-3">Usuario</th><th class="text-left p-3">Acci√≥n</th><th class="text-left p-3">M√≥dulo</th><th class="text-left p-3">IP</th><th class="text-left p-3">Acciones</th></tr></thead>
            <tbody>
              <template x-for="a in mockData.auditoria" :key="a.id">
                <tr class="border-t border-white/5 hover:bg-gold-20">
                  <td class="p-3 text-muted" x-text="a.hora"></td>
                  <td class="p-3" x-text="a.usuario"></td>
                  <td class="p-3"><span class="rounded px-2 py-0.5 text-xs bg-pagado/20" x-text="a.accion"></span></td>
                  <td class="p-3" x-text="a.modulo"></td>
                  <td class="p-3 text-muted" x-text="a.ip"></td>
                  <td class="p-3"><button @click="openModalAuditoria(a)" class="text-gold hover:underline">Ver</button></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Cierre de Caja -->
      <div x-show="currentPage === 'cierre'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">Cierre de Caja</h1>
          <button class="px-4 py-2 rounded-lg bg-pagado text-white font-medium">Cerrar Caja</button>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Ventas del d√≠a</div><div class="text-2xl font-bold text-gold">S/. 2,450</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Tickets</div><div class="text-2xl font-bold">47</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Efectivo</div><div class="text-2xl font-bold text-preparado">S/. 1,580</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Tarjeta/Digital</div><div class="text-2xl font-bold text-reservado">S/. 870</div></div>
          <div class="bg-card rounded-xl p-4 border border-reservado/40"><div class="text-muted text-sm">Complementos</div><div class="text-2xl font-bold text-reservado">S/. 1,290</div></div>
        </div>
        <div class="flex gap-2">
          <button :class="cierreTab === 'platos' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg" @click="cierreTab = 'platos'">Platos</button>
          <button :class="cierreTab === 'complementos' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg" @click="cierreTab = 'complementos'">Complementos</button>
          <button :class="cierreTab === 'categorias' ? 'bg-gold text-primary' : 'bg-card border border-gold-40'" class="px-3 py-1.5 rounded-lg" @click="cierreTab = 'categorias'">Categor√≠as</button>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <h3 class="font-semibold mb-4">Tabla Complementos</h3>
            <table class="w-full text-sm">
              <thead class="table-header"><tr><th class="text-left p-2">#</th><th class="text-left p-2">Complemento</th><th class="text-left p-2">Tipo</th><th class="text-left p-2">Cant.</th><th class="text-left p-2">Subtotal</th></tr></thead>
              <tbody>
                <template x-for="(comp, i) in mockData.cierreComplementos" :key="i">
                  <tr class="border-t border-white/5"><td class="p-2" x-text="i+1"></td><td class="p-2" x-text="comp.nombre"></td><td class="p-2"><span class="rounded px-1 text-xs bg-gold/20" x-text="comp.tipo"></span></td><td class="p-2" x-text="comp.cantidad"></td><td class="p-2 text-gold" x-text="'S/.' + comp.subtotal"></td></tr>
                </template>
              </tbody>
            </table>
            <div class="mt-4 flex gap-2">
              <button class="px-4 py-2 rounded-lg btn-gold">Cierre Completo (PDF)</button>
              <button class="px-4 py-2 rounded-lg bg-preparado text-primary">Complementos (Excel)</button>
            </div>
          </div>
          <div class="bg-card rounded-xl p-4 border border-gold-40">
            <h3 class="font-semibold mb-2">An√°lisis Complementos</h3>
            <p class="text-muted text-sm">Ratio complementos/plato: 1.8 ¬∑ M√°s popular: Inca Kola 500ml</p>
            <p class="text-sm mt-2">Ticket CON: S/. 68.50 ¬∑ SIN: S/. 42.30 ¬∑ <span class="text-preparado">+62%</span></p>
          </div>
        </div>
      </div>

      <!-- Reportes -->
      <div x-show="currentPage === 'reportes'" class="space-y-4">
        <div class="flex flex-wrap justify-between items-center gap-4">
          <h1 class="text-xl font-bold">Reportes y Anal√≠tica</h1>
          <div class="flex gap-2">
            <span class="px-2 py-1 rounded bg-pagado/20 text-pagado text-xs">LIVE</span>
            <button class="px-3 py-2 rounded-lg border border-gold-40 text-gold">PDF</button>
            <button class="px-3 py-2 rounded-lg border border-gold-40 text-gold">Excel</button>
            <button class="px-4 py-2 rounded-lg btn-outline-gold">Configurar Vista</button>
          </div>
        </div>
        <div class="flex gap-2 flex-wrap border-b border-gold-40 pb-2">
          <button @click="currentReportTab = 'general'" :class="currentReportTab === 'general' ? 'border-b-2 border-gold text-gold' : 'text-muted'" class="px-3 py-1.5">General</button>
          <button @click="currentReportTab = 'platos'" :class="currentReportTab === 'platos' ? 'border-b-2 border-gold text-gold' : 'text-muted'" class="px-3 py-1.5">Platos</button>
          <button @click="currentReportTab = 'mozos'" :class="currentReportTab === 'mozos' ? 'border-b-2 border-gold text-gold' : 'text-muted'" class="px-3 py-1.5">Mozos</button>
          <button @click="currentReportTab = 'mesas'" :class="currentReportTab === 'mesas' ? 'border-b-2 border-gold text-gold' : 'text-muted'" class="px-3 py-1.5">Mesas</button>
          <button @click="currentReportTab = 'clientes'" :class="currentReportTab === 'clientes' ? 'border-b-2 border-gold text-gold' : 'text-muted'" class="px-3 py-1.5">Clientes</button>
        </div>
        <div class="flex flex-wrap gap-2">
          <input type="date" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <input type="date" class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white">
          <select class="h-10 px-3 rounded-lg bg-card border border-gold-40 text-white"><option>Agrupar: D√≠a</option></select>
          <button class="px-3 py-1.5 rounded-lg bg-gold text-primary">Hoy</button>
          <button class="px-3 py-1.5 rounded-lg bg-card border border-gold-40">7 d√≠as</button>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" x-show="currentReportTab === 'general'">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Ventas Totales</div><div class="text-xl font-bold text-gold">S/. 12,450</div><span class="text-xs text-preparado">+18%</span></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Ticket Promedio</div><div class="text-xl font-bold">S/. 52.13</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Margen Bruto</div><div class="text-xl font-bold text-preparado">68.5%</div></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><div class="text-muted text-sm">Ocupaci√≥n Prom.</div><div class="text-xl font-bold text-pedido">74%</div></div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" x-show="currentReportTab === 'general'">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><h3 class="font-semibold mb-4">Ventas por Per√≠odo</h3><canvas id="chartReportesVentas" height="200"></canvas></div>
          <div class="bg-card rounded-xl p-4 border border-gold-40"><h3 class="font-semibold mb-4">Distribuci√≥n</h3><canvas id="chartReportesDonut" height="200"></canvas></div>
        </div>
        <div x-show="currentReportTab !== 'general'">
          <div class="bg-card rounded-xl p-4 border border-gold-40"><p class="text-muted">Vista: <span x-text="currentReportTab"></span></p></div>
        </div>
      </div>

      <!-- Configuraci√≥n -->
      <div x-show="currentPage === 'configuracion'" class="space-y-4">
        <div class="flex justify-between items-center">
          <h1 class="text-xl font-bold">Configuraci√≥n del Sistema</h1>
          <button class="px-4 py-2 rounded-lg btn-gold font-medium">Guardar Cambios</button>
        </div>
        <div class="flex flex-col md:flex-row gap-6">
          <div class="w-full md:w-48 shrink-0 space-y-1">
            <template x-for="t in configTabs" :key="t.id">
              <button @click="currentConfigTab = t.id" :class="currentConfigTab === t.id ? 'bg-gold-20 border-l-4 border-gold text-gold' : 'text-muted'" class="w-full text-left px-4 py-2 rounded-r border-l-4 border-transparent" x-text="t.label"></button>
            </template>
          </div>
          <div class="flex-1 bg-card rounded-xl p-6 border border-gold-40">
            <div x-show="currentConfigTab === 'general'">
              <h3 class="font-semibold text-gold mb-4">Informaci√≥n del Restaurante</h3>
              <div class="space-y-4">
                <div><label class="text-muted text-sm block mb-1">Nombre</label><input type="text" value="Las Gambusinas" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div><label class="text-muted text-sm block mb-1">Direcci√≥n</label><input type="text" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                  <div><label class="text-muted text-sm block mb-1">Tel√©fono</label><input type="text" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div><label class="text-muted text-sm block mb-1">Email</label><input type="email" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                  <div><label class="text-muted text-sm block mb-1">RUC</label><input type="text" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                </div>
              </div>
              <h3 class="font-semibold text-gold mt-6 mb-4">Horarios</h3>
              <div class="grid grid-cols-2 gap-4">
                <div><label class="text-muted text-sm block mb-1">Apertura</label><input type="time" value="08:00" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
                <div><label class="text-muted text-sm block mb-1">Cierre</label><input type="time" value="23:00" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
              </div>
              <div class="mt-4"><label class="text-muted text-sm block mb-1">Zona horaria</label><select class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"><option>America/Lima</option></select></div>
              <div class="mt-4"><label class="text-muted text-sm block mb-1">Idioma</label><select class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"><option>Espa√±ol</option></select></div>
            </div>
            <div x-show="currentConfigTab !== 'general'">
              <p class="text-muted">Secci√≥n: <span x-text="currentConfigTab"></span></p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Modal Personalizar Dashboard -->
    <div x-show="modalPersonalizar" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70" @click.self="modalPersonalizar = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-2xl max-h-[90vh] overflow-auto p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gold">Personalizar Dashboard</h2>
          <button @click="modalPersonalizar = false" class="p-2 rounded hover:bg-gold-20 text-muted">&times;</button>
        </div>
        <p class="text-muted text-sm mb-4">Arrastra los widgets para reordenar. Los cambios se guardan en tu sesi√≥n.</p>
        <div class="grid grid-cols-2 gap-3 mb-4">
          <div class="p-3 rounded-lg border border-gold-40">Mesas Ocupadas</div>
          <div class="p-3 rounded-lg border border-gold-40">Ventas del D√≠a</div>
          <div class="p-3 rounded-lg border border-gold-40">Ventas por Hora</div>
          <div class="p-3 rounded-lg border border-gold-40">Mapa de Mesas</div>
        </div>
        <div class="flex gap-2 justify-end">
          <button @click="modalPersonalizar = false" class="px-4 py-2 rounded-lg border border-gold-40 text-gold">Cerrar</button>
          <button @click="modalPersonalizar = false" class="px-4 py-2 rounded-lg btn-gold">Guardar</button>
        </div>
      </div>
    </div>

    <!-- Modal Mesa -->
    <div x-show="modalMesa" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70" @click.self="modalMesa = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-md p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gold" x-text="editingMesa ? 'Editar Mesa' : 'Nueva Mesa'"></h2>
          <button @click="modalMesa = false" class="p-2 rounded hover:bg-gold-20 text-muted">&times;</button>
        </div>
        <div class="space-y-4">
          <div><label class="text-muted text-sm block mb-1">N√∫mero de mesa</label><input type="number" x-model="formMesa.numero" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
          <div><label class="text-muted text-sm block mb-1">√Årea</label><select x-model="formMesa.areaId" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"><template x-for="a in mockData.areas" :key="a.id"><option :value="a.id" x-text="a.nombre"></option></template></select></div>
          <div><label class="text-muted text-sm block mb-1">Capacidad</label><input type="number" x-model="formMesa.capacidad" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
        </div>
        <div class="flex gap-2 justify-end mt-6">
          <button @click="modalMesa = false" class="px-4 py-2 rounded-lg border border-gold-40 text-gold">Cancelar</button>
          <button @click="saveMesa(); modalMesa = false" class="px-4 py-2 rounded-lg btn-gold">Guardar</button>
        </div>
      </div>
    </div>

    <!-- Modal Plato (crear/editar) -->
    <div x-show="modalPlato" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4" @click.self="modalPlato = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-2xl max-h-[90vh] overflow-auto p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gold" x-text="editingPlato ? 'Editar Plato' : 'Crear Nuevo Plato'"></h2>
          <button @click="modalPlato = false" class="p-2 rounded hover:bg-gold-20 text-muted">&times;</button>
        </div>
        <div class="space-y-4">
          <div><label class="text-muted text-sm block mb-1">Nombre</label><input type="text" x-model="formPlato.nombre" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
          <div class="grid grid-cols-2 gap-4">
            <div><label class="text-muted text-sm block mb-1">Precio (S/.)</label><input type="number" x-model="formPlato.precio" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
            <div><label class="text-muted text-sm block mb-1">Stock</label><input type="number" x-model="formPlato.stock" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"></div>
          </div>
          <div><label class="text-muted text-sm block mb-1">Categor√≠a</label><select x-model="formPlato.categoria" class="w-full h-10 px-3 rounded-lg bg-sidebar border border-gold-40 text-white"><option>Ceviches</option><option>Arroces</option><option>Bebidas</option></select></div>
          <div><label class="text-muted text-sm block mb-1">Complementos (grupos)</label><p class="text-sm text-muted">Este plato tiene <span x-text="(formPlato.complementos || []).length"></span> grupos. A√±adir en backend.</p></div>
        </div>
        <div class="flex gap-2 justify-end mt-6">
          <button @click="modalPlato = false" class="px-4 py-2 rounded-lg border border-gold-40 text-gold">Cancelar</button>
          <button @click="savePlato(); modalPlato = false" class="px-4 py-2 rounded-lg btn-gold">Crear Plato</button>
        </div>
      </div>
    </div>

    <!-- Modal Ver Comanda -->
    <div x-show="modalComanda" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4" @click.self="modalComanda = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-2xl max-h-[90vh] overflow-auto p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gold">Comanda #<span x-text="selectedComanda?.id"></span></h2>
          <button @click="modalComanda = false" class="p-2 rounded hover:bg-gold-20 text-muted">&times;</button>
        </div>
        <template x-if="selectedComanda">
          <div class="space-y-2 text-sm">
            <p>Mesa: <span x-text="selectedComanda.mesa"></span> ¬∑ Mozo: <span x-text="selectedComanda.mozo"></span></p>
            <p class="text-gold font-semibold">Total: S/.<span x-text="selectedComanda.total"></span></p>
          </div>
        </template>
        <div class="mt-4"><button @click="modalComanda = false" class="px-4 py-2 rounded-lg btn-gold">Cerrar</button></div>
      </div>
    </div>

    <!-- Modal Ver Boucher -->
    <div x-show="modalBoucher" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4" @click.self="modalBoucher = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-lg p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gold">Boucher #<span x-text="selectedBoucher?.numero"></span></h2>
          <button @click="modalBoucher = false" class="p-2 rounded hover:bg-gold-20 text-muted">&times;</button>
        </div>
        <template x-if="selectedBoucher">
          <p class="text-gold font-semibold text-lg">Total: S/.<span x-text="selectedBoucher.total"></span></p>
        </template>
        <div class="mt-4"><button @click="modalBoucher = false" class="px-4 py-2 rounded-lg btn-gold">Cerrar</button></div>
      </div>
    </div>

    <!-- Modal Cliente / Auditor√≠a (placeholder) -->
    <div x-show="modalCliente" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70" @click.self="modalCliente = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-md p-6">
        <h2 class="text-xl font-bold text-gold mb-4">Editar Cliente</h2>
        <template x-if="selectedCliente"><p x-text="selectedCliente.nombre"></p></template>
        <button @click="modalCliente = false" class="mt-4 px-4 py-2 rounded-lg btn-gold">Cerrar</button>
      </div>
    </div>
    <div x-show="modalAuditoria" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70" @click.self="modalAuditoria = false">
      <div class="bg-card rounded-xl border border-gold-40 w-full max-w-lg p-6">
        <h2 class="text-xl font-bold text-gold mb-4">Detalle Auditor√≠a</h2>
        <template x-if="selectedAuditoria"><p class="text-muted text-sm" x-text="selectedAuditoria.detalles || selectedAuditoria.accion"></p></template>
        <button @click="modalAuditoria = false" class="mt-4 px-4 py-2 rounded-lg btn-gold">Cerrar</button>
      </div>
    </div>

  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('dashboardApp', () => ({
        sidebarOpen: true,
        currentPage: 'dashboard',
        currentReportTab: 'general',
        currentConfigTab: 'general',
        vistaMesas: 'tarjetas',
        platosTab: 'todos',
        cierreTab: 'complementos',
        searchOpen: false,
        searchQuery: '',
        statusOpen: false,
        shortcutsOpen: false,
        notificationsOpen: false,
        profileOpen: false,
        modalPersonalizar: false,
        modalMesa: false,
        modalPlato: false,
        modalComanda: false,
        modalBoucher: false,
        modalCliente: false,
        modalAuditoria: false,
        modalArea: false,
        modalMozo: false,
        editingMesa: null,
        editingPlato: null,
        selectedComanda: null,
        selectedBoucher: null,
        selectedCliente: null,
        selectedAuditoria: null,
        clockTime: '00:00:00',
        clockDate: '',
        filtroMesas: '',
        filtroAreaMesas: '',
        filtroEstadoMesas: '',
        formMesa: { numero: '', areaId: '', capacidad: 4 },
        formPlato: { nombre: '', precio: '', stock: 0, categoria: '', complementos: [] },

        menuItems: [
          { id: 'dashboard', label: 'Dashboard', icon: 'üìä' },
          { id: 'mesas', label: 'Mesas', icon: 'ü™ë' },
          { id: 'areas', label: '√Åreas', icon: 'üó∫Ô∏è' },
          { id: 'mozos', label: 'Mozos', icon: 'üë§' },
          { id: 'platos', label: 'Platos', icon: 'üç≤' },
          { id: 'comandas', label: 'Comandas', icon: 'üìã' },
          { id: 'bouchers', label: 'Bouchers', icon: 'üßÇ' },
          { id: 'clientes', label: 'Clientes', icon: 'üë•' },
          { id: 'auditoria', label: 'Auditor√≠a', icon: 'üîç' },
          { id: 'cierre', label: 'Cierre Caja', icon: 'üí∞' },
          { id: 'reportes', label: 'Reportes', icon: 'üìä' },
          { id: 'configuracion', label: 'Configuraci√≥n', icon: '‚öôÔ∏è' }
        ],

        configTabs: [
          { id: 'general', label: 'General' },
          { id: 'moneda', label: 'Moneda y Precios' },
          { id: 'mesas', label: 'Mesas y √Åreas' },
          { id: 'cocina', label: 'Cocina' },
          { id: 'pagos', label: 'Pagos y Facturaci√≥n' },
          { id: 'notificaciones', label: 'Notificaciones' },
          { id: 'cierre', label: 'Cierre de Caja' },
          { id: 'seguridad', label: 'Seguridad' },
          { id: 'integraciones', label: 'Integraciones' },
          { id: 'avanzado', label: 'Avanzado' }
        ],

        mockData: {
          areas: [
            { id: '1', nombre: 'Sal√≥n Principal', descripcion: '√Årea principal' },
            { id: '2', nombre: 'Terraza', descripcion: 'Exterior' },
            { id: '3', nombre: 'VIP', descripcion: 'Privado' }
          ],
          mesas: [
            { id: '1', numero: 1, areaId: '1', estado: 'Libre', estadoColor: 'libre', areaNombre: 'Sal√≥n Principal', mozo: null, monto: null },
            { id: '2', numero: 2, areaId: '1', estado: 'Ocupada', estadoColor: 'esperando', areaNombre: 'Sal√≥n Principal', mozo: 'Juan P√©rez', monto: 125 },
            { id: '3', numero: 3, areaId: '1', estado: 'Reservada', estadoColor: 'reservado', areaNombre: 'Sal√≥n Principal', mozo: null, monto: null },
            { id: '4', numero: 4, areaId: '2', estado: 'Libre', estadoColor: 'libre', areaNombre: 'Terraza', mozo: null, monto: null },
            { id: '5', numero: 5, areaId: '2', estado: 'Ocupada', estadoColor: 'pedido', areaNombre: 'Terraza', mozo: 'Mar√≠a G.', monto: 68 }
          ],
          mozos: [
            { id: '1', nombre: 'Juan P√©rez', dni: '12345678', telefono: '999111222' },
            { id: '2', nombre: 'Mar√≠a Gonz√°lez', dni: '87654321', telefono: '999333444' }
          ],
          platos: [
            { id: '1', nombre: 'Ceviche Cl√°sico', precio: 45, stock: 50, categoria: 'Ceviches', subcategoria: '', complementos: [{ nombre: 'Prote√≠na' }, { nombre: 'Guarnici√≥n' }] },
            { id: '2', nombre: 'Paella Marinera', precio: 68, stock: 30, categoria: 'Arroces', subcategoria: '', complementos: [{ nombre: 'Bebida' }] },
            { id: '3', nombre: 'Lomo Saltado', precio: 35, stock: 45, categoria: 'Carnes', subcategoria: '', complementos: [] },
            { id: '4', nombre: 'Jugo Natural', precio: 12, stock: 8, categoria: 'Bebidas', subcategoria: '', complementos: [{ nombre: 'Tama√±o' }] }
          ],
          comandas: [
            { id: 305, mesa: 'Mesa 5', mozo: 'Juan P√©rez', items: 4, total: 193, estado: 'En proceso' },
            { id: 306, mesa: 'Mesa 2', mozo: 'Mar√≠a G.', items: 2, total: 78, estado: 'Preparando' }
          ],
          bouchers: [
            { id: '1', codigo: 'BCH-001', numero: '100', fecha: '24/02/2026', total: 193 },
            { id: '2', codigo: 'BCH-001', numero: '101', fecha: '24/02/2026', total: 78 }
          ],
          clientes: [
            { id: '1', nombre: 'Carlos L√≥pez', dni: '20123456789', telefono: '998877665', visitas: 12, gastoTotal: 1450, tipo: 'Registrado' },
            { id: '2', nombre: 'Ana Mart√≠nez', dni: '20987654321', telefono: '987654321', visitas: 28, gastoTotal: 3200, tipo: 'Frecuente' }
          ],
          auditoria: [
            { id: '1', hora: '14:32', usuario: 'Admin', accion: 'Comanda Eliminada', modulo: 'Comandas', ip: '192.168.1.45', detalles: 'Comanda #300' },
            { id: '2', hora: '14:15', usuario: 'Admin', accion: 'Plato Modificado', modulo: 'Platos', ip: '192.168.1.45', detalles: 'Ceviche Cl√°sico - precio' }
          ],
          cierreComplementos: [
            { nombre: 'Inca Kola 500ml', tipo: 'Bebida', cantidad: 24, subtotal: 288 },
            { nombre: 'Guarnici√≥n Arroz', tipo: 'Extra', cantidad: 18, subtotal: 90 }
          ]
        },

        get breadcrumb() {
          const labels = { dashboard: 'Dashboard', mesas: 'Mesas', areas: '√Åreas', mozos: 'Mozos', platos: 'Platos', comandas: 'Comandas', bouchers: 'Bouchers', clientes: 'Clientes', auditoria: 'Auditor√≠a', cierre: 'Cierre Caja', reportes: 'Reportes', configuracion: 'Configuraci√≥n' };
          return labels[this.currentPage] || 'Dashboard';
        },
        get saludo() {
          const h = new Date().getHours();
          if (h < 12) return 'd√≠as';
          if (h < 19) return 'tardes';
          return 'noches';
        },
        get dashboardKpis() {
          const ocupadas = this.mockData.mesas.filter(m => m.estado !== 'Libre' && m.estado !== 'Reservada').length;
          return { mesasOcupadas: ocupadas, mesasTotal: this.mockData.mesas.length, ventasHoy: '2,450', topPlato: 'Ceviche Cl√°sico', topMozo: 'Juan P√©rez', alertas: 2 };
        },
        get mesasMapa() {
          return this.mockData.mesas.slice(0, 20).map(m => ({ ...m }));
        },
        get actividadReciente() {
          return [
            { id: 1, hora: '14:35', texto: 'Comanda #305 lista para servir' },
            { id: 2, hora: '14:28', texto: 'Mesa 5 - Pedido enviado a cocina' },
            { id: 3, hora: '14:15', texto: 'Pago procesado S/. 185 - Mesa 3' }
          ];
        },
        get mesasFiltradas() {
          let list = this.mockData.mesas;
          if (this.filtroAreaMesas) list = list.filter(m => m.areaId === this.filtroAreaMesas);
          if (this.filtroEstadoMesas) list = list.filter(m => m.estado.toLowerCase() === this.filtroEstadoMesas);
          if (this.filtroMesas) list = list.filter(m => String(m.numero).includes(this.filtroMesas));
          return list;
        },
        get categoriasPlatos() {
          return [{ nombre: 'Ceviches', count: 24 }, { nombre: 'Arroces', count: 18 }, { nombre: 'Bebidas', count: 35 }];
        },
        get searchResults() {
          const q = (this.searchQuery || '').toLowerCase();
          if (q.length < 2) return { platos: [], mesas: [] };
          return {
            platos: this.mockData.platos.filter(p => p.nombre.toLowerCase().includes(q)).slice(0, 5),
            mesas: this.mockData.mesas.filter(m => String(m.numero).includes(q)).slice(0, 3)
          };
        },
        get notifications() {
          return [
            { id: 1, texto: 'Mesa 8 sin liberar', hora: 'Hace 5 min', urgente: true, leida: false, icono: 'üî¥' },
            { id: 2, texto: 'Stock bajo: Inca Kola', hora: 'Hace 12 min', urgente: false, leida: false, icono: 'üü°' },
            { id: 3, texto: 'Nueva comanda #312', hora: 'Hace 20 min', urgente: false, leida: true, icono: 'üîµ' }
          ];
        },
        get notifUnread() { return this.notifications.filter(n => !n.leida).length; },

        navigateTo(page) { this.currentPage = page; },
        openModalMesa(mesa) { this.editingMesa = mesa || null; this.formMesa = mesa ? { numero: mesa.numero, areaId: mesa.areaId, capacidad: 4 } : { numero: '', areaId: '1', capacidad: 4 }; this.modalMesa = true; },
        openModalArea() { this.modalArea = true; },
        openModalMozo(mozo) { this.modalMozo = true; },
        openModalPlato(plato) { this.editingPlato = plato || null; this.formPlato = plato ? { nombre: plato.nombre, precio: plato.precio, stock: plato.stock, categoria: plato.categoria, complementos: plato.complementos || [] } : { nombre: '', precio: '', stock: 0, categoria: '', complementos: [] }; this.modalPlato = true; },
        openModalComanda(c) { this.selectedComanda = c; this.modalComanda = true; },
        openModalBoucher(b) { this.selectedBoucher = b; this.modalBoucher = true; },
        openModalCliente(c) { this.selectedCliente = c; this.modalCliente = true; },
        openModalAuditoria(a) { this.selectedAuditoria = a; this.modalAuditoria = true; },
        verDetalleMesa(m) { this.openModalMesa(m); },
        mesaColor(estado) {
          const map = { libre: '#00d4aa', esperando: '#ffa502', pedido: '#3498db', preparado: '#2ecc71', pagado: '#ff4757', reservado: '#5352ed' };
          return map[estado] || '#5a5a7a';
        },
        saveMesa() { if (!this.editingMesa) this.mockData.mesas.push({ id: String(this.mockData.mesas.length + 1), numero: this.formMesa.numero, areaId: this.formMesa.areaId, estado: 'Libre', estadoColor: 'libre', areaNombre: this.mockData.areas.find(a => a.id === this.formMesa.areaId)?.nombre || '', mozo: null, monto: null }); },
        savePlato() { if (!this.editingPlato) this.mockData.platos.push({ id: String(this.mockData.platos.length + 1), nombre: this.formPlato.nombre, precio: this.formPlato.precio, stock: this.formPlato.stock, categoria: this.formPlato.categoria, complementos: [] }); },

        init() {
          const tick = () => {
            const d = new Date();
            this.clockTime = d.toTimeString().slice(0, 8);
            this.clockDate = d.toLocaleDateString('es-PE', { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' });
          };
          tick();
          setInterval(tick, 1000);
          if (typeof lucide !== 'undefined') lucide.createIcons();
          this.$nextTick(() => {
            if (typeof Chart !== 'undefined') {
              const gold = 'rgba(212,175,55,0.8)';
              const ctx1 = document.getElementById('chartVentasHora');
              if (ctx1) {
                new Chart(ctx1.getContext('2d'), {
                  type: 'line',
                  data: { labels: ['08h', '10h', '12h', '14h', '16h', '18h'], datasets: [{ label: 'Ventas', data: [120, 340, 580, 720, 650, 430], borderColor: gold, backgroundColor: 'rgba(212,175,55,0.1)', fill: true }] },
                  options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' } }, x: { grid: { display: false } } } }
                });
              }
              const ctx2 = document.getElementById('chartReportesVentas');
              if (ctx2) {
                new Chart(ctx2.getContext('2d'), {
                  type: 'line',
                  data: { labels: ['08h', '10h', '12h', '14h', '16h'], datasets: [{ label: 'Ventas', data: [1200, 2800, 4200, 5800, 7200], borderColor: gold, fill: true, backgroundColor: 'rgba(212,175,55,0.15)' }] },
                  options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true }, x: {} } }
                });
              }
              const ctx3 = document.getElementById('chartReportesDonut');
              if (ctx3) {
                new Chart(ctx3.getContext('2d'), {
                  type: 'doughnut',
                  data: {
                    labels: ['Ceviches', 'Arroces', 'Carnes', 'Bebidas', 'Otros'],
                    datasets: [{ data: [30, 22, 18, 15, 15], backgroundColor: [gold, '#3498db', '#2ecc71', '#ffa502', '#5352ed'] }]
                  },
                  options: { responsive: true, plugins: { legend: { position: 'right' } } }
                });
              }
            }
          });
        }
      }));
    });
  </script>
</div>
</body>
</html>
